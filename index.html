<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì˜ì–´íšŒí™” ìŠ¤í„°ë””</title>
  <style>
    :root{
      --main:#4f46e5; --bg:#f4f6fb; --card:#fff; --text:#1f2937;
      --danger:#dc2626; --muted:#6b7280; --line:#e5e7eb;
      --ok:#16a34a;
    }
    *{box-sizing:border-box;}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:var(--bg);color:var(--text);}
    header{background:var(--main);color:#fff;display:flex;justify-content:space-around;padding:12px 0;position:sticky;top:0;z-index:5;flex-wrap:wrap;gap:6px;}
    header button{background:none;border:none;color:#fff;font-size:14px;cursor:pointer;padding:8px 10px;border-radius:10px;}
    header button.active{background:rgba(255,255,255,.18);}
    .container{padding:16px;max-width:980px;margin:0 auto;}
    .card{background:var(--card);border-radius:14px;padding:16px;margin-bottom:14px;box-shadow:0 8px 22px rgba(0,0,0,0.06);}
    .hidden{display:none;}
    .primary{background:var(--main);color:#fff;border:none;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700;}
    .primary:active{transform:translateY(1px);}
    .sub{background:#eef2ff;border:1px solid #c7d2fe;padding:12px;border-radius:12px;width:100%;margin-bottom:8px;cursor:pointer;text-align:left;font-weight:700;}
    .sub.active{background:var(--main);color:#fff;border-color:var(--main);}
    input,select{width:100%;padding:11px;margin-top:6px;border:1px solid var(--line);border-radius:12px;background:#fff;font-size:16px;}
    .danger{background:var(--danger);color:#fff;border:none;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:800;}
    .ghost{background:#fff;border:1px solid var(--line);padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700;}
    .small{font-size:13px;color:var(--muted);line-height:1.4;}
    .ok{color:var(--ok);font-weight:900;}
    .no{color:var(--danger);font-weight:900;}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;}
    .row > *{flex:1;min-width:140px;}
    .pill{display:inline-block;padding:5px 10px;border-radius:999px;background:#f3f4f6;font-size:12px;color:#111;}
    .note{padding:12px;border-radius:12px;background:#f9fafb;border:1px dashed var(--line);}
    hr.sep{border:none;border-top:1px solid var(--line);margin:12px 0;}
    .listItem{border-top:1px dashed var(--line);padding-top:12px;margin-top:12px;}
    .kpi{display:flex;justify-content:space-between;gap:10px;align-items:flex-start;}
    .kpi .big{font-size:24px;font-weight:950;letter-spacing:-0.3px;}
    .banner{
      padding:14px;border-radius:14px;background:linear-gradient(135deg,#eef2ff,#ffffff);
      border:1px solid #dbeafe;
    }

    /* ì²´í¬ë°•ìŠ¤ ì˜ì—­(ëª¨ë°”ì¼ì—ì„œ í™”ë©´ ë°–ìœ¼ë¡œ ì•ˆ ë‚˜ê°€ê²Œ) */
    .chkGrid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:8px;}
    .chkGrid label{
      display:flex;gap:8px;align-items:center;
      padding:10px;border:1px solid var(--line);border-radius:12px;background:#fff;cursor:pointer;
      min-width:0;
      font-size:14px;
    }
    .chkGrid input{width:auto;margin:0;flex:none;}
    @media (max-width:520px){
      .chkGrid{max-width:80vw;}
      .chkGrid label{font-size:13px;padding:9px;}
    }

    /* âœ… ì €ì¥/ì‚­ì œ ë²„íŠ¼ì„ ë¬¸ì¥ë§í•˜ê¸°í›ˆë ¨ì²˜ëŸ¼ ì„¸ë¡œë¡œ í¬ê²Œ */
    .btnStack{display:flex;flex-direction:column;gap:10px;margin-top:12px;}
    .btnStack button{width:100%;padding:14px 14px;font-size:16px;border-radius:14px;}

    /* ëª¨ë‹¬ */
    .modalBack{
      position:fixed;inset:0;background:rgba(0,0,0,.38);
      display:flex;align-items:center;justify-content:center;
      z-index:9999;padding:18px;
    }
    .modal{
      width:min(520px, 92vw);
      background:#fff;border-radius:18px;
      box-shadow:0 20px 60px rgba(0,0,0,.25);
      overflow:hidden;
      transform:translateY(10px) scale(.98);
      animation:pop .18s ease-out forwards;
    }
    @keyframes pop{ to{transform:translateY(0) scale(1);} }
    .modalTop{
      padding:18px 18px 12px;
      background:linear-gradient(135deg,#4f46e5,#7c3aed);
      color:#fff;
    }
    .modalTop h3{margin:0;font-size:18px;letter-spacing:-0.2px;}
    .modalBody{padding:16px 18px;}
    .modalBody .bigMsg{font-size:20px;font-weight:950;letter-spacing:-0.4px;line-height:1.35;}
    .modalBody .subMsg{margin-top:8px;color:var(--muted);font-size:13px;line-height:1.45;}
    .modalActions{padding:14px 18px;display:flex;justify-content:flex-end;gap:10px;background:#fafafa;border-top:1px solid var(--line);}

    .footerActions{
      margin-top:12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .footerActions > *{flex:1;min-width:160px;}

    /* âœ… ì¸íŠ¸ë¡œ/ì´ë¦„ì„ íƒ í™”ë©´ iPhone ê°ì„± */
    #nameScreen{min-height:100vh;display:flex;align-items:center;justify-content:center;}
    /* âœ… (ì¤‘ìš”) #nameScreenì´ id ìŠ¤íƒ€ì¼ë¡œ display:flexë¥¼ ê°–ê³  ìˆì–´ì„œ,
       hiddenì´ ì•ˆ ë¨¹ë˜ ë¬¸ì œë¥¼ í•´ê²°: ì˜ˆì „ì²˜ëŸ¼ "ìƒˆ í™”ë©´ì²˜ëŸ¼" ì „í™˜ë©ë‹ˆë‹¤ */
    #nameScreen.hidden{display:none !important;}

    .loginCard{
      width:min(520px, 92vw);
      background:rgba(255,255,255,.88);
      border:1px solid rgba(229,231,235,.75);
      border-radius:22px;
      box-shadow:0 18px 50px rgba(0,0,0,.10);
      padding:18px;
      backdrop-filter:saturate(150%) blur(10px);
      -webkit-backdrop-filter:saturate(150%) blur(10px);
    }
    .loginTop{
      display:flex;align-items:flex-start;justify-content:space-between;gap:14px;
      padding:10px 10px 12px;
      border-radius:18px;
      background:linear-gradient(135deg, rgba(79,70,229,.12), rgba(124,58,237,.08));
      border:1px solid rgba(199,210,254,.6);
    }
    .brand .title{
      margin:0;
      font-size:18px;         /* í•œ ì¤„ ê³ ì • */
      font-weight:950;
      letter-spacing:-0.6px;
      color:#111827;

      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .brand .subtitle{
      margin:6px 0 0;
      font-size:14px;
      color:var(--muted);
      line-height:1.4;
    }
    .mascot{
      width:74px;height:74px;border-radius:18px;
      display:flex;align-items:center;justify-content:center;
      background:rgba(255,255,255,.65);
      border:1px solid rgba(229,231,235,.7);
      box-shadow:0 10px 24px rgba(0,0,0,.08);
      flex:none;
    }
    .loginActions{padding:14px 6px 6px;}
    .rememberRow{
      margin-top:10px;
      display:flex;gap:10px;align-items:center;
      padding:12px 12px;
      border:1px solid var(--line);
      border-radius:14px;
      background:#fff;
    }
    .rememberRow input{width:auto;margin:0;}
    #startBtn{
      width:100%;
      margin-top:12px;
      padding:16px 14px;
      font-size:17px;
      border-radius:16px;
      font-weight:900;
      letter-spacing:-0.2px;
    }
  </style>
</head>

<body>

<script>
/** ===== ì°¸ê°€ì/í‚¤ ===== */
const USERS = ["ì˜¤ì„¤ë€","ì˜¤ë¯¸ì§„","ê¹€ë¯¸ë‚˜"];
const ADMIN = "ê¹€ë¯¸ë‚˜";

const KEY = "studyData";                 // ì¼ìë³„ ê¸°ë¡(ì´ˆê¸°í™” ëŒ€ìƒ)
const LS_USER = "currentUser";
const LS_REMEMBER = "rememberMe";
const KEY_ACC = "accSpeakingMinutes";    // ëˆ„ì ì‹œê°„(ì´ˆê¸°í™”í•´ë„ ìœ ì§€)

/** (ì˜ˆì „ ë²„ì „/ì‹¤í—˜ì—ì„œ ì“°ì˜€ì„ ê°€ëŠ¥ì„±ì´ ìˆëŠ” í‚¤ë“¤ê¹Œì§€ ê°™ì´ ì •ë¦¬) */
const LEGACY_KEYS = [
  "studyData", "studyData_v1", "studyData_v2",
  "englishStudyAppData", "studyLogs", "glideStudyData",
  "fines", "fineData", "penaltyData"
];

/** ===== ë²Œê¸ˆ ì‹œì‘ì¼(ìƒˆë²½2ì‹œ ê¸°ì¤€) ===== */
const LS_FINE_START = "fineStartKey";

/** âœ… ê³µë¶€ ë§ˆê°(ìƒˆë²½ 2ì‹œ) ë°˜ì˜í•œ â€œí•™ìŠµì¼ í‚¤â€ */
function todayKey(){
  const now = new Date();
  const y = now.getFullYear();
  const m = String(now.getMonth() + 1).padStart(2, "0");
  const d = String(now.getDate()).padStart(2, "0");

  // ìƒˆë²½ 2ì‹œ ì´ì „ì´ë©´ â€œì „ë‚ â€ë¡œ ì¸ì •
  const hour = now.getHours();
  if(hour < 2){
    const prev = new Date(now);
    prev.setDate(now.getDate() - 1);
    const py = prev.getFullYear();
    const pm = String(prev.getMonth() + 1).padStart(2, "0");
    const pd = String(prev.getDate()).padStart(2, "0");
    return `${py}-${pm}-${pd}`;
  }
  return `${y}-${m}-${d}`;
}

/** âœ… í™”ë©´ í‘œì‹œìš©: YYYY-MM-DD (ìš”ì¼) */
function displayKeyWithWeekday(isoKey){
  const [y, m, d] = isoKey.split("-").map(Number);
  const dt = new Date(y, m - 1, d);
  const wd = ["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "][dt.getDay()];
  const mm = String(m).padStart(2, "0");
  const dd = String(d).padStart(2, "0");
  return `${y}-${mm}-${dd} (${wd})`;
}

/** âœ… iOS Safari ë‚ ì§œ íŒŒì‹±/ISO ë³€í™˜ìœ¼ë¡œ í•˜ë£¨ ë°€ë¦¬ëŠ” ë¬¸ì œ ë°©ì§€(UTC ì•ˆì „) */
function dateKeyPlusDays(isoKey, delta){
  const [y, m, d] = isoKey.split("-").map(Number);
  const utc = Date.UTC(y, m - 1, d) + (delta * 86400000);
  return new Date(utc).toISOString().slice(0, 10);
}

/** âœ… ì£¼ë§(í† /ì¼) íŒë³„ */
function isWeekendKey(isoKey){
  const [y, m, d] = isoKey.split("-").map(Number);
  const dt = new Date(y, m - 1, d);
  const day = dt.getDay(); // 0=ì¼, 6=í† 
  return day === 0 || day === 6;
}

/** ===== ë²Œê¸ˆ ì‹œì‘ì¼(í•œ ë²ˆë§Œ) ì„¸íŒ…: 2026-01-26 ===== */
function ensureFineStart(){
  // âœ… ë²Œê¸ˆ ì‹œì‘ì¼(ê³ ì •): 2026-01-26
  // ì˜ˆì „ í…ŒìŠ¤íŠ¸ë¡œ ë” ì´ë¥¸ ë‚ ì§œê°€ ì €ì¥ë¼ ìˆìœ¼ë©´(ì˜ˆ: 2026-01-19) ê·¸ ê°’ ë•Œë¬¸ì— ê³¼ê±° ê²°ì„ ë²Œê¸ˆì´ í•©ì‚°ë  ìˆ˜ ìˆì–´ìš”.
  // ê·¸ë˜ì„œ ì €ì¥ëœ ê°’ì´ ìˆì–´ë„ ì‹œì‘ì¼ë³´ë‹¤ ë¹ ë¥´ë©´ ì‹œì‘ì¼ë¡œ ê°•ì œ ë³´ì •í•©ë‹ˆë‹¤.
  const DEFAULT_START = "2026-01-26";
  const saved = localStorage.getItem(LS_FINE_START);
  if(saved){
    if(saved < DEFAULT_START){
      localStorage.setItem(LS_FINE_START, DEFAULT_START);
      return DEFAULT_START;
    }
    return saved;
  }
  localStorage.setItem(LS_FINE_START, DEFAULT_START);
  return DEFAULT_START;
}

/** ===== ì €ì¥ ===== */
function load(){ return JSON.parse(localStorage.getItem(KEY)) || {}; }
function save(data){ localStorage.setItem(KEY, JSON.stringify(data)); }
function remembered(){ return localStorage.getItem(LS_REMEMBER) === "1"; }
function currentUser(){ return localStorage.getItem(LS_USER) || ""; }
function getActiveUser(){ return currentUser() || window.__tempUser || ""; }

function ensureRow(data, dateKey, user){
  data[dateKey] ??= {};
  data[dateKey][user] ??= {};
  data[dateKey][user].wordAttempts ??= [];
  data[dateKey][user].patternAttempts ??= [];
  data[dateKey][user].readingPage ??= "";
  return data[dateKey][user];
}

function hasAnyRecord(row){
  if(!row) return false;
  const hasWord = (row.wordAttempts || []).length > 0;
  const hasPattern = (row.patternAttempts || []).length > 0;
  const hasSpeaking = typeof row.speakingTime === "string" && row.speakingTime.length > 0;
  const hasReading = typeof row.readingPage === "string" && row.readingPage.length > 0;
  return hasWord || hasPattern || hasSpeaking || hasReading;
}

/** ===== ë²Œê¸ˆ ê³„ì‚° (ì£¼ë§ 0ì›, ì‹œì‘ì¼ ì´ì „ 0ì›, ë§ˆê°(ìƒˆë²½2ì‹œ) ì´í›„ ê¸°ë¡ì—†ìŒì´ë©´ 20,000ì›) ===== */
function calcFineForDateWithData(data, dateKey, user){
  const fineStart = ensureFineStart();
  if(dateKey < fineStart) return 0;

  if(isWeekendKey(dateKey)) return 0;

  const row = data[dateKey]?.[user];

  // âœ… â€œê¸°ë¡ ì—†ìŒâ€ì´ë©´: ë§ˆê°(ìƒˆë²½2ì‹œ) ì§€ë‚¬ì„ ë•Œë§Œ 20,000ì›
  if(!hasAnyRecord(row)){
    const now = new Date();
    const nowY = now.getFullYear();
    const nowM = String(now.getMonth()+1).padStart(2,"0");
    const nowD = String(now.getDate()).padStart(2,"0");
    const todayIso = `${nowY}-${nowM}-${nowD}`;

    // dateKeyê°€ "í•™ìŠµì¼" ê¸°ì¤€ì´ë¯€ë¡œ, ì‹¤ì œ ë§ˆê°ì€ ë‹¤ìŒë‚  02:00
    const [y,m,d] = dateKey.split("-").map(Number);
    const cutoff = new Date(y, m-1, d+1, 2, 0, 0); // ë‹¤ìŒë‚  ìƒˆë²½2ì‹œ

    if(now >= cutoff) return 20000;
    return 0;
  }

  let fine = 0;

  // ë‹¨ì–´ ë¶ˆí•©ê²© ì²´í¬ 1ê°œë‹¹ 4,000ì›
  let wordFail = 0;
  for(const a of (row.wordAttempts || [])){
    for(const o of (a.outcomes || [])){
      if(o === "í•œ>ì˜ ë¶ˆí•©ê²©" || o === "ì˜>í•œ ë¶ˆí•©ê²©") wordFail++;
    }
  }
  fine += wordFail * 4000;

  // íŒ¨í„´ ë¶ˆí•©ê²© 4,000ì›
  fine += (row.patternAttempts || []).filter(p => p.result === "ë¶ˆí•©ê²©").length * 4000;

  // ë¬¸ì¥ë§í•˜ê¸° 30ë¶„ ì´í•˜ 4,000ì›
  if(row.speakingTime === "30ë¶„ ì´í•˜") fine += 4000;

  // ë…ì„œ 3í˜ì´ì§€ ì´í•˜ 4,000ì›
  if(row.readingPage === "3í˜ì´ì§€ ì´í•˜") fine += 4000;

  return fine;
}
function calcFineForDate(dateKey, user){
  const data = load();
  return calcFineForDateWithData(data, dateKey, user);
}

/** ===== ëˆ„ì ì‹œê°„(ì´ˆê¸°í™”í•´ë„ ìœ ì§€) ===== */
function loadAcc(){ return JSON.parse(localStorage.getItem(KEY_ACC)) || {}; }
function saveAcc(acc){ localStorage.setItem(KEY_ACC, JSON.stringify(acc)); }

function timeToMinutes(label){
  const map = {
    "30ë¶„ ì´í•˜": 0,
    "30ë¶„": 30,
    "40ë¶„": 40,
    "50ë¶„": 50,
    "60ë¶„": 60,
    "2ì‹œê°„": 120,
    "3ì‹œê°„": 180,
    "4ì‹œê°„": 240,
  };
  return map[label] ?? 0;
}
function addAcc(user, minutes){
  const acc = loadAcc();
  acc[user] = (acc[user] || 0) + minutes;
  saveAcc(acc);
}
function subAcc(user, minutes){
  const acc = loadAcc();
  acc[user] = Math.max(0, (acc[user] || 0) - minutes);
  saveAcc(acc);
}

/** ===== í™”ë©´ ===== */
function setNavActive(screenId){
  const ids = ["record","today","fine4w","accTime"];
  ids.forEach(id=>{
    const btn = document.getElementById("nav-"+(id==="fine4w"?"fine":id==="accTime"?"acc":id));
    if(btn) btn.classList.toggle("active", id === screenId);
  });
}
function showScreen(id){
  document.querySelectorAll(".screen").forEach(s=>s.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
  setNavActive(id);
  renderAll();
}
function openSub(subId, btnEl){
  document.querySelectorAll(".sub").forEach(b=>b.classList.remove("active"));
  if(btnEl) btnEl.classList.add("active");
  document.querySelectorAll("[id^='sub-']").forEach(s=>s.classList.add("hidden"));
  document.getElementById("sub-"+subId).classList.remove("hidden");
}

/** ===== ì˜µì…˜ êµ¬ì„± ===== */
function buildWordRanges(){
  const sel = document.getElementById("wordRange");
  sel.innerHTML = "";
  for(let start=1; start<=1100; start+=50){
    const end = Math.min(start+49, 1100);
    const opt = document.createElement("option");
    opt.value = `${start}-${end}`;
    opt.textContent = `${start}-${end}ë²ˆ`;
    sel.appendChild(opt);
  }
}
function buildPatternDays(){
  const sel = document.getElementById("patternDay");
  sel.innerHTML = "";
  for(let i=1;i<=20;i++){
    const opt = document.createElement("option");
    opt.value = `Day${i}`;
    opt.textContent = `Day${i}`;
    sel.appendChild(opt);
  }
  sel.value = "Day1";
}

/** ===== ë‹¨ì–´ ===== */
function getSelectedWordOutcomes(){
  return Array.from(document.querySelectorAll("#wordOutcomeBox input[type='checkbox']:checked")).map(x=>x.value);
}
function clearWordSelections(){
  document.querySelectorAll("#wordOutcomeBox input[type='checkbox']").forEach(x=>x.checked=false);
}
function saveWord(){
  const u = getActiveUser();
  if(!u) return showModal("ì´ë¦„ í•„ìš”", "ì´ë¦„ ì„ íƒ í›„ ì´ìš©í•  ìˆ˜ ìˆì–´ìš”.");

  const k = todayKey();
  const data = load();
  const row = ensureRow(data, k, u);

  const range = document.getElementById("wordRange").value;
  const outcomes = getSelectedWordOutcomes();
  if(outcomes.length === 0) return showModal("ê²°ê³¼ ì„ íƒ í•„ìš”", "ê²°ê³¼ë¥¼ 1ê°œ ì´ìƒ ì„ íƒí•´ì¤˜.");

  if(row.wordAttempts.some(a => a.range === range)){
    return showModal("ì¤‘ë³µ ì €ì¥ ë°©ì§€", "ì˜¤ëŠ˜ì€ ì´ êµ¬ê°„ì´ ì´ë¯¸ ì €ì¥ë˜ì–´ ìˆì–´ìš”. (ì‚­ì œ í›„ ë‹¤ì‹œ ì €ì¥ ê°€ëŠ¥)");
  }

  row.wordAttempts.push({ range, outcomes, ts: Date.now() });
  save(data);
  clearWordSelections();
  renderAll();
}
function deleteWord(range){
  if(!confirm("ì‚­ì œí• ê¹Œìš”?")) return;
  const u = getActiveUser();
  const data = load();
  const k = todayKey();
  const row = data[k]?.[u];
  if(!row) return;
  row.wordAttempts = (row.wordAttempts||[]).filter(a=>a.range !== range);
  save(data);
  renderAll();
}
function deleteSelectedWord(){
  const u = getActiveUser();
  if(!u) return showModal("ì´ë¦„ í•„ìš”", "ì´ë¦„ ì„ íƒ í›„ ì´ìš©í•  ìˆ˜ ìˆì–´ìš”.");

  const range = document.getElementById("wordRange").value;
  const data = load();
  const k = todayKey();
  const row = data[k]?.[u];
  if(!row || !(row.wordAttempts||[]).some(a=>a.range===range)){
    return showModal("ì‚­ì œí•  ê¸°ë¡ ì—†ìŒ", `ì˜¤ëŠ˜ ì €ì¥ëœ "${range}ë²ˆ" ê¸°ë¡ì´ ì—†ì–´ìš”.`);
  }
  deleteWord(range);
}

/** ===== íŒ¨í„´ ===== */
function savePattern(){
  const u = getActiveUser();
  if(!u) return showModal("ì´ë¦„ í•„ìš”", "ì´ë¦„ ì„ íƒ í›„ ì´ìš©í•  ìˆ˜ ìˆì–´ìš”.");

  const k = todayKey();
  const data = load();
  const row = ensureRow(data, k, u);

  const day = document.getElementById("patternDay").value;
  const result = document.getElementById("patternResult").value;

  if(row.patternAttempts.some(p => p.day === day)){
    return showModal("ì¤‘ë³µ ì €ì¥ ë°©ì§€", "ì˜¤ëŠ˜ì€ ì´ Dayê°€ ì´ë¯¸ ì €ì¥ë˜ì–´ ìˆì–´ìš”. (ì‚­ì œ í›„ ë‹¤ì‹œ ì €ì¥ ê°€ëŠ¥)");
  }

  row.patternAttempts.push({ day, result, ts: Date.now() });
  save(data);
  renderAll();
}
function deletePattern(day){
  if(!confirm("ì‚­ì œí• ê¹Œìš”?")) return;
  const u = getActiveUser();
  const data = load();
  const k = todayKey();
  const row = data[k]?.[u];
  if(!row) return;
  row.patternAttempts = (row.patternAttempts||[]).filter(p=>p.day !== day);
  save(data);
  renderAll();
}
function deleteSelectedPattern(){
  const u = getActiveUser();
  if(!u) return showModal("ì´ë¦„ í•„ìš”", "ì´ë¦„ ì„ íƒ í›„ ì´ìš©í•  ìˆ˜ ìˆì–´ìš”.");

  const day = document.getElementById("patternDay").value;
  const data = load();
  const k = todayKey();
  const row = data[k]?.[u];
  if(!row || !(row.patternAttempts||[]).some(p=>p.day===day)){
    return showModal("ì‚­ì œí•  ê¸°ë¡ ì—†ìŒ", `ì˜¤ëŠ˜ ì €ì¥ëœ "${day}" ê¸°ë¡ì´ ì—†ì–´ìš”.`);
  }
  deleteWord(day);
}

/** ===== ë§í•˜ê¸° ===== */
function saveSpeaking(){
  const u = getActiveUser();
  if(!u) return showModal("ì´ë¦„ í•„ìš”", "ì´ë¦„ ì„ íƒ í›„ ì´ìš©í•  ìˆ˜ ìˆì–´ìš”.");

  const k = todayKey();
  const data = load();
  const row = ensureRow(data, k, u);

  const t = document.getElementById("speakingTime").value;
  if(!t) return showModal("ì‹œê°„ ì„ íƒ í•„ìš”", "í›ˆë ¨ ì‹œê°„ì„ ì„ íƒí•´ì¤˜.");

  if(row.speakingTime){
    const old = row.speakingTime;
    if(old === t){
      return showModal("ì´ë¯¸ ì €ì¥ë¨", "ì˜¤ëŠ˜ì€ ê°™ì€ ì‹œê°„ìœ¼ë¡œ ì´ë¯¸ ì €ì¥ë˜ì–´ ìˆì–´ìš”.");
    }
    subAcc(u, timeToMinutes(old));
    addAcc(u, timeToMinutes(t));
    row.speakingTime = t;
    save(data);
    renderAll();
    return;
  }

  row.speakingTime = t;
  save(data);
  addAcc(u, timeToMinutes(t));
  renderAll();
}

function deleteSpeaking(){
  if(!confirm("ì‚­ì œí• ê¹Œìš”? (ëˆ„ì ì‹œê°„ë„ í•¨ê»˜ ë˜ëŒë¦½ë‹ˆë‹¤)")) return;
  const u = getActiveUser();
  const data = load();
  const k = todayKey();
  const row = data[k]?.[u];
  if(!row || !row.speakingTime) return;

  subAcc(u, timeToMinutes(row.speakingTime));
  delete row.speakingTime;
  save(data);

  const sel = document.getElementById("speakingTime");
  if(sel) sel.value = "";

  renderAll();
}

/** ===== ë…ì„œ =====
 * - ì˜¤ëŠ˜ ë…ì„œ í˜ì´ì§€ ì„ íƒ ì €ì¥
 * - ì´ë¯¸ ì €ì¥ë˜ì–´ ìˆìœ¼ë©´ "ìˆ˜ì • ì €ì¥"ìœ¼ë¡œ ì²˜ë¦¬
 */
function saveReading(){
  const u = getActiveUser();
  if(!u) return showModal("ì´ë¦„ í•„ìš”", "ì´ë¦„ ì„ íƒ í›„ ì´ìš©í•  ìˆ˜ ìˆì–´ìš”.");

  const k = todayKey();
  const data = load();
  const row = ensureRow(data, k, u);

  const v = document.getElementById("readingPage").value;
  if(!v) return showModal("ì„ íƒ í•„ìš”", "ë…ì„œ í˜ì´ì§€ë¥¼ ì„ íƒí•´ì¤˜.");

  // ì´ë¯¸ ì €ì¥ë˜ì–´ ìˆìœ¼ë©´ ìˆ˜ì •
  if(row.readingPage){
    if(row.readingPage === v){
      return showModal("ì´ë¯¸ ì €ì¥ë¨", "ì˜¤ëŠ˜ì€ ê°™ì€ ê°’ìœ¼ë¡œ ì´ë¯¸ ì €ì¥ë˜ì–´ ìˆì–´ìš”.");
    }
    row.readingPage = v;
    save(data);
    renderAll();
    return;
  }

  row.readingPage = v;
  save(data);
  renderAll();
}

function deleteReading(){
  if(!confirm("ì‚­ì œí• ê¹Œìš”?")) return;
  const u = getActiveUser();
  const data = load();
  const k = todayKey();
  const row = data[k]?.[u];
  if(!row || !row.readingPage) return;

  delete row.readingPage;
  save(data);

  const sel = document.getElementById("readingPage");
  if(sel) sel.value = "";

  renderAll();
}

/** ===== ë Œë” ===== */
function renderWordTodayList(){
  const el = document.getElementById("todayWordItems");
  const u = getActiveUser();
  const data = load();
  const k = todayKey();
  const arr = data[k]?.[u]?.wordAttempts || [];
  if(arr.length === 0){ el.innerHTML = `<span class="pill">ì—†ìŒ</span>`; return; }
  el.innerHTML = arr.map(a=>{
    const fails = (a.outcomes||[]).filter(o=>o==="í•œ>ì˜ ë¶ˆí•©ê²©"||o==="ì˜>í•œ ë¶ˆí•©ê²©").length;
    const fine = fails*4000;
    return `
      <div style="margin-top:10px;">
        <b>${a.range}ë²ˆ</b>
        <span class="pill" style="margin-left:6px;background:${fails? "#fee2e2":"#dcfce7"};color:${fails? "#991b1b":"#166534"};">
          ${fails? `ë¶ˆí•©ê²© ${fails}ê°œ / ${fine.toLocaleString()}ì›` : "ë¶ˆí•©ê²© ì—†ìŒ"}
        </span><br>
        <span class="small">${(a.outcomes||[]).join(", ")}</span>
      </div>
    `;
  }).join("");
}
function renderPatternTodayList(){
  const el = document.getElementById("todayPatternItems");
  const u = getActiveUser();
  const data = load();
  const k = todayKey();
  const arr = data[k]?.[u]?.patternAttempts || [];
  if(arr.length === 0){ el.innerHTML = `<span class="pill">ì—†ìŒ</span>`; return; }
  el.innerHTML = arr.map(p=>{
    const fine = (p.result==="ë¶ˆí•©ê²©") ? 4000 : 0;
    return `
      <div style="margin-top:10px;">
        <b>${p.day}</b>
        <span class="pill" style="margin-left:6px;background:${fine? "#fee2e2":"#dcfce7"};color:${fine? "#991b1b":"#166534"};">
          ${p.result}${fine? ` / ${fine.toLocaleString()}ì›`:""}
        </span>
      </div>
    `;
  }).join("");
}
function renderSpeakingToday(){
  const el = document.getElementById("todaySpeakingItem");
  const u = getActiveUser();
  const data = load();
  const k = todayKey();
  const t = data[k]?.[u]?.speakingTime || "";
  if(!t){ el.innerHTML = `<span class="pill">ì—†ìŒ</span>`; return; }
  const fine = (t==="30ë¶„ ì´í•˜") ? 4000 : 0;
  el.innerHTML = `<span class="pill" style="background:${fine? "#fee2e2":"#dcfce7"};color:${fine? "#991b1b":"#166534"};">
    ${t}${fine? ` / ${fine.toLocaleString()}ì›`:" / ë²Œê¸ˆ ì—†ìŒ"}
  </span>`;
}

function renderReadingToday(){
  const el = document.getElementById("todayReadingItem");
  const u = getActiveUser();
  const data = load();
  const k = todayKey();
  const v = data[k]?.[u]?.readingPage || "";
  if(!v){ el.innerHTML = `<span class="pill">ì—†ìŒ</span>`; return; }
  const fine = (v === "3í˜ì´ì§€ ì´í•˜") ? 4000 : 0;
  el.innerHTML = `<span class="pill" style="background:${fine? "#fee2e2":"#dcfce7"};color:${fine? "#991b1b":"#166534"};">
    ${v}${fine? ` / ${fine.toLocaleString()}ì›`:" / ë²Œê¸ˆ ì—†ìŒ"}
  </span>`;
}

function renderTodayFine(){
  const u = getActiveUser();
  const k = todayKey();
  const basis = document.getElementById("basisDate");
  if(basis) basis.textContent = displayKeyWithWeekday(k);

  const fine = calcFineForDate(k, u);
  const big = document.getElementById("todayFineBig");
  if(big) big.textContent = fine.toLocaleString() + "ì›";

  const data = load();
  const row = data[k]?.[u];
  const detail = document.getElementById("todayFineDetail");
  if(!detail) return;

  if(isWeekendKey(k)){
    detail.innerHTML = `í† /ì¼ì€ íœ´ë¬´ë¼ì„œ ë²Œê¸ˆ ì •ì‚°ì´ ì—†ìŠµë‹ˆë‹¤. <b>(0ì›)</b>`;
    return;
  }

  // ê¸°ë¡ ì—†ìŒì´ë©´(ë§ˆê° ì „ì—ëŠ” 0ì›, ë§ˆê° í›„ì—ëŠ” 20,000ì›) â€” ì„¤ëª…ì€ ê·¸ëŒ€ë¡œ ë¹„ì›Œë‘ 
  if(!hasAnyRecord(row)){
    detail.innerHTML = ``;
    return;
  }

  let wordFail=0;
  for(const a of (row?.wordAttempts||[])){
    for(const o of (a.outcomes||[])){
      if(o==="í•œ>ì˜ ë¶ˆí•©ê²©"||o==="ì˜>í•œ ë¶ˆí•©ê²©") wordFail++;
    }
  }
  const patternFail=(row?.patternAttempts||[]).filter(p=>p.result==="ë¶ˆí•©ê²©").length;
  const speakUnder30=(row?.speakingTime==="30ë¶„ ì´í•˜");
  const readUnder3=(row?.readingPage==="3í˜ì´ì§€ ì´í•˜");

  detail.innerHTML =
    `ë‹¨ì–´ ë¶ˆí•©ê²© ì²´í¬ ${wordFail}ê°œ â†’ ${(wordFail*4000).toLocaleString()}ì›<br>` +
    `íŒ¨í„´ ë¶ˆí•©ê²© ${patternFail}íšŒ â†’ ${(patternFail*4000).toLocaleString()}ì›<br>` +
    `ë¬¸ì¥ë§í•˜ê¸° 30ë¶„ ì´í•˜ ${speakUnder30?"ì˜ˆ":"ì•„ë‹ˆì˜¤"} â†’ ${(speakUnder30?4000:0).toLocaleString()}ì›<br>` +
    `ë…ì„œ 3í˜ì´ì§€ ì´í•˜ ${readUnder3?"ì˜ˆ":"ì•„ë‹ˆì˜¤"} â†’ ${(readUnder3?4000:0).toLocaleString()}ì›`;
}

function renderTodayScreen(){
  const data = load();
  const k = todayKey();
  const el = document.getElementById("today");
  if(!el) return;

  const me = getActiveUser();
  el.innerHTML = `
    <div class="card">
      <h3 style="margin:0 0 6px;">ì˜¤ëŠ˜ í˜„í™©</h3>
      <div class="small">${displayKeyWithWeekday(k)} </div>
    </div>
  `;

  const row = data[k]?.[me];
  const ok = hasAnyRecord(row);

  let statusHTML = "";
  if(isWeekendKey(k)){
    statusHTML = `<span class="ok">ğŸ˜´ ì£¼ë§ íœ´ë¬´</span>`;
  }else if(ok){
    statusHTML = `<span class="ok">â­• ê¸°ë¡ ìˆìŒ</span>`;
  }else{
    statusHTML = `<span class="no">âŒ ê¸°ë¡ ì—†ìŒ</span>`;
  }

  el.innerHTML += `<div class="card"><b>${me}</b><br>${statusHTML}</div>`;
}

function renderFine4w(){
  const baseKey = todayKey();
  const body = document.getElementById("fine4wBody");
  if(!body) return;
  body.innerHTML = "";

  const data = load();
  const me = getActiveUser();

  let sum = 0;
  for(let i=0;i<7;i++){
    const dk = dateKeyPlusDays(baseKey, -i);
    sum += calcFineForDateWithData(data, dk, me);
  }

  body.innerHTML += `<div class="card"><b>${me}</b><br>ì´ ë²Œê¸ˆ: <b>${sum.toLocaleString()}ì›</b></div>`;
}

function formatMinutes(mins){
  const h = Math.floor(mins/60);
  const m = mins % 60;
  if(h<=0) return `${m}ë¶„`;
  if(m===0) return `${h}ì‹œê°„`;
  return `${h}ì‹œê°„ ${m}ë¶„`;
}
function renderAcc(){
  const acc = loadAcc();
  const el = document.getElementById("accBody");
  if(!el) return;
  el.innerHTML = "";

  const me = getActiveUser();
  const mins = acc[me] || 0;
  el.innerHTML += `
    <div class="card">
      <b>${me}</b><br>
      ë§í•˜ê¸°í›ˆë ¨ ëˆ„ì ì‹œê°„: <b>${formatMinutes(mins)}</b>
    </div>
  `;
}

function renderAdminControls(){
  // ê°œì¸ ì•±ì—ì„œ ëª¨ë‘ ì´ˆê¸°í™” ë²„íŠ¼ ì‚¬ìš© ê°€ëŠ¥(ë¹„ë²ˆ ë™ì¼)
  const adminBox = document.getElementById("adminControls");
  if(!adminBox) return;
  adminBox.classList.remove("hidden");
}

function renderAll(){
  if(!document.getElementById("app").classList.contains("hidden")){
    renderAdminControls();

    renderWordTodayList();
    renderPatternTodayList();
    renderSpeakingToday();
    renderReadingToday();
    renderTodayFine();

    renderTodayScreen();
    renderFine4w();
    renderAcc();
  }
}

function resetAll(){
  const txt = prompt("ì „ì²´ ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”");
  if(txt !== "20262026") return alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ì–´ìš”.");

  // ê¸°ë¡ ë°ì´í„° + ë²Œê¸ˆ ì‹œì‘ì¼ ì´ˆê¸°í™”(ë‹¤ì‹œ 2026-01-26ë¡œ ì‹œì‘)
  localStorage.removeItem(KEY);
  localStorage.removeItem(LS_FINE_START);
  LEGACY_KEYS.forEach(k => localStorage.removeItem(k));

  alert("ì´ˆê¸°í™” ì™„ë£Œ (ëˆ„ì ì‹œê°„ì€ ìœ ì§€ë©ë‹ˆë‹¤)");
  renderAll();
}

function logout(){
  localStorage.removeItem(LS_USER);
  localStorage.removeItem(LS_REMEMBER);
  delete window.__tempUser;

  document.getElementById("app").classList.add("hidden");
  document.getElementById("nameScreen").classList.remove("hidden");

  const sel = document.getElementById("userSelect");
  if(sel) sel.value = "";
  const rem = document.getElementById("rememberMe");
  if(rem) rem.checked = false;

  showModal("ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ", "ì´ë¦„ì„ ë‹¤ì‹œ ì„ íƒí•´ì„œ ë“¤ì–´ì˜¬ ìˆ˜ ìˆì–´ìš”.");
}

function showModal(title, body){
  const root = document.getElementById("modalRoot");
  root.classList.remove("hidden");
  root.innerHTML = `
    <div class="modalBack" onclick="closeModal(event)">
      <div class="modal" onclick="event.stopPropagation()">
        <div class="modalTop">
          <h3>${escapeHtml(title)}</h3>
        </div>
        <div class="modalBody">
          <div class="bigMsg">${escapeHtml(body)}</div>
        </div>
        <div class="modalActions">
          <button class="primary" onclick="closeModal()">í™•ì¸</button>
        </div>
      </div>
    </div>
  `;
}
function showWelcome(){
  const msg = "3ë…„ë’¤ (ì„¤ë€Â·ë¯¸ì§„Â·ë¯¸ë‚˜) ì•¼ ë„ˆë‘!";
  const sub = "ì˜¤ëŠ˜ì˜ ì‘ì€ ê¸°ë¡ì´, 3ë…„ ë’¤ì˜ í° ì‹¤ë ¥ìœ¼ë¡œ âœ¨";
  const root = document.getElementById("modalRoot");
  root.classList.remove("hidden");
  root.innerHTML = `
    <div class="modalBack" onclick="closeModal(event)">
      <div class="modal" onclick="event.stopPropagation()">
        <div class="modalTop">
          <h3>ğŸ”¥ ìŠ¤í„°ë”” ì‹œì‘!</h3>
        </div>
        <div class="modalBody">
          <div class="bigMsg">${escapeHtml(msg)}</div>
          <div class="subMsg">${escapeHtml(sub)}</div>
        </div>
        <div class="modalActions">
          <button class="primary" onclick="closeModal()">ê°€ì!</button>
        </div>
      </div>
    </div>
  `;
}
function closeModal(e){
  const root = document.getElementById("modalRoot");
  root.classList.add("hidden");
  root.innerHTML = "";
}
function escapeHtml(s){
  return String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"quot;").replaceAll("'","&#039;");
}

function startApp(){
  const sel = document.getElementById("userSelect");
  const rememberChk = document.getElementById("rememberMe");
  const name = (sel?.value || "").trim();
  if(!name) return showModal("ì´ë¦„ ì„ íƒ í•„ìš”", "ì´ë¦„ì„ ì„ íƒí•œ ë’¤ ì‹œì‘ì„ ëˆŒëŸ¬ì¤˜.");

  if(rememberChk?.checked){
    localStorage.setItem(LS_USER, name);
    localStorage.setItem(LS_REMEMBER, "1");
    delete window.__tempUser;
  }else{
    localStorage.removeItem(LS_USER);
    localStorage.removeItem(LS_REMEMBER);
    window.__tempUser = name;
  }

  document.getElementById("nameScreen").classList.add("hidden");
  document.getElementById("app").classList.remove("hidden");

  showScreen("record");
  showWelcome();
  renderAll();
}

function boot(){
  buildWordRanges();
  buildPatternDays();
  ensureFineStart();

  if(remembered() && currentUser()){
    document.getElementById("nameScreen").classList.add("hidden");
    document.getElementById("app").classList.remove("hidden");
    showScreen("record");
    showWelcome();
    renderAll();
  }

  let __lastDayKey = todayKey();
  setInterval(() => {
    const app = document.getElementById("app");
    if(!app || app.classList.contains("hidden")) return;

    const nowKey = todayKey();
    if(nowKey !== __lastDayKey){
      __lastDayKey = nowKey;
      renderAll();
      return;
    }

    const bd = document.getElementById("basisDate");
    if(bd) bd.textContent = displayKeyWithWeekday(nowKey);

    renderAll();
  }, 30 * 1000);
}
document.addEventListener("DOMContentLoaded", boot);
</script>

<!-- âœ… ì´ë¦„ ì„ íƒ -->
<div id="nameScreen" class="container">
  <div class="loginCard">
    <div class="loginTop">
      <div class="brand">
        <h3 class="title">ì‚¼ë…„ë’¤ ì˜ì–´ìŠ¤í„°ë””</h3>
        <p class="subtitle"> 3ë…„ ë’¤ ìš°ë¦¬ì˜ ì˜ì–´ìš´ëª…ì€(ë‚¨ë¯¸,ë°•ì‚¬ê³¼ì •) </p>
      </div>

      <div class="mascot" aria-hidden="true">
        <svg width="74" height="74" viewBox="0 0 74 74" fill="none" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="g1" x1="10" y1="10" x2="64" y2="64" gradientUnits="userSpaceOnUse">
              <stop stop-color="#4F46E5" stop-opacity="0.22"/>
              <stop offset="1" stop-color="#7C3AED" stop-opacity="0.16"/>
            </linearGradient>
          </defs>
          <rect x="0.8" y="0.8" width="72.4" height="72.4" rx="18" fill="url(#g1)"/>
          <circle cx="25" cy="42" r="9" fill="#FFFFFF" opacity="0.95"/>
          <circle cx="37" cy="42" r="9" fill="#FFFFFF" opacity="0.95"/>
          <circle cx="49" cy="42" r="9" fill="#FFFFFF" opacity="0.95"/>
          <circle cx="20" cy="33" r="10" fill="#FFFFFF" opacity="0.98"/>
          <circle cx="17" cy="32" r="2" fill="#111827"/>
          <circle cx="23" cy="32" r="2" fill="#111827"/>
          <path d="M16.5 36.2C18.1 38.4 21.9 38.4 23.5 36.2" stroke="#111827" stroke-width="1.6" stroke-linecap="round"/>
          <circle cx="14.6" cy="35" r="1.8" fill="#FCA5A5" opacity="0.85"/>
          <circle cx="25.4" cy="35" r="1.8" fill="#FCA5A5" opacity="0.85"/>
          <path d="M16 25C14.2 22.6 13.6 20.3 13.8 18" stroke="#111827" stroke-width="1.6" stroke-linecap="round"/>
          <path d="M24 25C25.8 22.6 26.4 20.3 26.2 18" stroke="#111827" stroke-width="1.6" stroke-linecap="round"/>
          <circle cx="13.8" cy="18" r="2" fill="#111827"/>
          <circle cx="26.2" cy="18" r="2" fill="#111827"/>
          <path d="M56 20l1.2 2.6L60 24l-2.8 1.4L56 28l-1.2-2.6L52 24l2.8-1.4L56 20z" fill="#FFFFFF" opacity="0.9"/>
          <path d="M58 48l0.9 2L61 51l-2.1 1L58 54l-0.9-2L55 51l2.1-1L58 48z" fill="#FFFFFF" opacity="0.85"/>
        </svg>
      </div>
    </div>

    <div class="loginActions">
      <label class="small" style="margin:0;">í•™ìŠµì(ì´ë¦„ì„ ì„ íƒí•´ì£¼ì„¸ìš”)</label>
      <select id="userSelect" style="margin-top:10px;">
        <option value="">ì„ íƒ</option>
        <option>ì˜¤ì„¤ë€</option>
        <option>ì˜¤ë¯¸ì§„</option>
        <option>ê¹€ë¯¸ë‚˜</option>
      </select>

      <div class="rememberRow">
        <input id="rememberMe" type="checkbox">
        <label for="rememberMe" class="small" style="margin:0; cursor:pointer;">
          ë¡œê·¸ì¸ ìœ ì§€(ì²´í¬í•˜ë©´ ë‹¤ìŒë¶€í„° ìë™ ë¡œê·¸ì¸)
        </label>
      </div>

      <button id="startBtn" class="primary" onclick="startApp()">ì‹œì‘í•˜ê¸°</button>
    </div>
  </div>
</div>

<!-- ì•± -->
<div id="app" class="hidden">
  <header>
    <button id="nav-record" class="active" onclick="showScreen('record')">ì˜¤ëŠ˜ ê¸°ë¡</button>
    <button id="nav-today" onclick="showScreen('today')">ì˜¤ëŠ˜ í˜„í™©</button>
    <button id="nav-fine" onclick="showScreen('fine4w')">1ì£¼ ë²Œê¸ˆ</button>
    <button id="nav-acc" onclick="showScreen('accTime')">ëˆ„ì ì‹œê°„</button>
  </header>

  <div class="container">
    <div id="record" class="screen">
      <div class="card">
        <h3 style="margin:0 0 10px;">ì˜¤ëŠ˜ ê³µë¶€ ê¸°ë¡</h3>
        <div class="small">ê¸°ì¤€ì¼: <span id="basisDate"></span> </div>

        <div class="note small" style="margin-top:10px;">
          *ì˜¤ëŠ˜ ë§ˆê°ì‹œê°„ê¹Œì§€(ìƒˆë²½2ì‹œ) ì•„ë¬´ ê¸°ë¡ì´ ì—†ìœ¼ë©´ "ê²°ì„"ìœ¼ë¡œ ê°„ì£¼í•˜ê³  ë²Œê¸ˆ 20,000ì› í™•ì •/*í† ì¼ì€ í•™ìŠµ íœ´ë¬´(ë²Œê¸ˆ ì—†ìŒ)
        </div>

        <hr class="sep">
        <button class="sub" onclick="openSub('word', this)">A. ë‹¨ì–´ 1ì´ˆ ë§í•˜ê¸°</button>
        <button class="sub" onclick="openSub('pattern', this)">B. íŒ¨í„´ì‹œí—˜</button>
        <button class="sub" onclick="openSub('speaking', this)">C. ë¬¸ì¥ë§í•˜ê¸°í›ˆë ¨</button>
        <button class="sub" onclick="openSub('reading', this)">D. ë…ì„œ</button>

        <div id="sub-word" class="card hidden" style="margin-top:12px;">
          <p style="margin:0 0 10px;"><b>ë‹¨ì–´ 1ì´ˆ ë§í•˜ê¸°</b></p>
          <div class="small">ë²ˆí˜¸ êµ¬ê°„ ì„ íƒ + ê²°ê³¼(ë³µìˆ˜ ì„ íƒ)</div>

          <div style="margin-top:10px;">
            <label class="small">ë‹¨ì–´ ë²ˆí˜¸ êµ¬ê°„ (50ê°œ ë‹¨ìœ„)</label>
            <select id="wordRange"></select>
          </div>

          <div style="margin-top:10px;">
            <label class="small">ê²°ê³¼ (ì—¬ëŸ¬ ê°œ ì„ íƒ ê°€ëŠ¥)</label>
            <div class="chkGrid" id="wordOutcomeBox">
              <label><input type="checkbox" value="í•œ>ì˜ í•©ê²©">í•œ>ì˜ í•©ê²©</label>
              <label><input type="checkbox" value="í•œ>ì˜ ë¶ˆí•©ê²©">í•œ>ì˜ ë¶ˆí•©ê²©</label>
              <label><input type="checkbox" value="ì˜>í•œ í•©ê²©">ì˜>í•œ í•©ê²©</label>
              <label><input type="checkbox" value="ì˜>í•œ ë¶ˆí•©ê²©">ì˜>í•œ ë¶ˆí•©ê²©</label>
            </div>
            <p class="small" style="margin:8px 0 0;">ë²Œê¸ˆ: <b>ë¶ˆí•©ê²© ì²´í¬ 1ê°œë‹¹ 4,000ì›</b></p>
          </div>

          <div class="btnStack">
            <button class="primary" onclick="saveWord()">ì €ì¥</button>
            <button class="danger" onclick="deleteSelectedWord()">ì‚­ì œ</button>
          </div>

          <div class="listItem">
            <div class="small"><b>ì˜¤ëŠ˜ ì €ì¥ëœ ë‹¨ì–´ ê¸°ë¡</b> (ê°™ì€ êµ¬ê°„ ì¤‘ë³µ ì €ì¥ ë¶ˆê°€)</div>
            <div id="todayWordItems" class="small" style="margin-top:8px;"></div>
          </div>
        </div>

        <div id="sub-pattern" class="card hidden" style="margin-top:12px;">
          <p style="margin:0 0 8px;"><b>íŒ¨í„´ì‹œí—˜</b></p>

          <div style="margin-top:10px;">
            <label class="small">Day ì„ íƒ</label>
            <select id="patternDay"></select>
          </div>

          <div style="margin-top:10px;">
            <label class="small">ê²°ê³¼</label>
            <select id="patternResult">
              <option value="í•©ê²©">í•©ê²©</option>
              <option value="ë¶ˆí•©ê²©">ë¶ˆí•©ê²©</option>
            </select>
            <p class="small" style="margin:8px 0 0;">ë²Œê¸ˆ: ë¶ˆí•©ê²©ì´ë©´ <b>4,000ì›</b></p>
          </div>

          <div class="btnStack">
            <button class="primary" onclick="savePattern()">ì €ì¥</button>
            <button class="danger" onclick="deleteSelectedPattern()">ì‚­ì œ</button>
          </div>

          <div class="listItem">
            <div class="small"><b>ì˜¤ëŠ˜ ì €ì¥ëœ íŒ¨í„´ ê¸°ë¡</b> (ê°™ì€ Day ì¤‘ë³µ ì €ì¥ ë¶ˆê°€)</div>
            <div id="todayPatternItems" class="small" style="margin-top:8px;"></div>
          </div>
        </div>

        <div id="sub-speaking" class="card hidden" style="margin-top:12px;">
          <p style="margin:0 0 8px;"><b>ë¬¸ì¥ë§í•˜ê¸°í›ˆë ¨</b></p>

          <div style="margin-top:10px;">
            <label class="small">í›ˆë ¨ ì‹œê°„</label>
            <select id="speakingTime">
              <option value="">ì„ íƒ</option>
              <option value="30ë¶„ ì´í•˜">30ë¶„ ì´í•˜</option>
              <option value="30ë¶„">30ë¶„</option>
              <option value="40ë¶„">40ë¶„</option>
              <option value="50ë¶„">50ë¶„</option>
              <option value="60ë¶„">60ë¶„</option>
              <option value="2ì‹œê°„">2ì‹œê°„</option>
              <option value="3ì‹œê°„">3ì‹œê°„</option>
              <option value="4ì‹œê°„">4ì‹œê°„</option>
            </select>
            <p class="small" style="margin:8px 0 0;">ë²Œê¸ˆ: <b>30ë¶„ ì´í•˜</b> ì„ íƒ ì‹œ <b>4,000ì›</b></p>
          </div>

          <div class="btnStack">
            <button class="primary" onclick="saveSpeaking()">ì €ì¥</button>
            <button class="danger" onclick="deleteSpeaking()">ì‚­ì œ</button>
          </div>

          <div class="listItem">
            <div class="small"><b>ì˜¤ëŠ˜ ì €ì¥ëœ ë¬¸ì¥ë§í•˜ê¸°í›ˆë ¨</b></div>
            <div id="todaySpeakingItem" class="small" style="margin-top:8px;"></div>
          </div>
        </div>

        <!-- D -->
        <div id="sub-reading" class="card hidden" style="margin-top:12px;">
          <p style="margin:0 0 8px;"><b>ë…ì„œ</b></p>

          <div style="margin-top:10px;">
            <label class="small">ë…ì„œ í˜ì´ì§€</label>
            <select id="readingPage">
              <option value="">ì„ íƒ</option>
              <option value="3í˜ì´ì§€ ì´í•˜">3í˜ì´ì§€ ì´í•˜</option>
              <option value="3í˜ì´ì§€ ì´ìƒ">3í˜ì´ì§€ ì´ìƒ</option>
            </select>
            <p class="small" style="margin:8px 0 0;">ë²Œê¸ˆ: <b>3í˜ì´ì§€ ì´í•˜</b> ì„ íƒ ì‹œ <b>4,000ì›</b></p>
          </div>

          <div class="btnStack">
            <button class="primary" onclick="saveReading()">ì €ì¥</button>
            <button class="danger" onclick="deleteReading()">ì‚­ì œ</button>
          </div>

          <div class="listItem">
            <div class="small"><b>ì˜¤ëŠ˜ ì €ì¥ëœ ë…ì„œ</b></div>
            <div id="todayReadingItem" class="small" style="margin-top:8px;"></div>
          </div>
        </div>

        <!-- ì˜¤ëŠ˜ ë²Œê¸ˆ -->
        <div class="card" style="margin-top:12px;">
          <div class="kpi">
            <div>
              <div class="small">ì˜¤ëŠ˜ ë‚´ ë²Œê¸ˆ</div>
              <div id="todayFineBig" class="big">0ì›</div>
            </div>
            <div><span class="pill">ìë™ ê³„ì‚°</span></div>
          </div>
          <div id="todayFineDetail" class="small" style="margin-top:10px;"></div>
        </div>

      </div>
    </div>

    <div id="today" class="screen hidden"></div>

    <div id="fine4w" class="screen hidden">
      <div class="card">
        <div class="row" style="align-items:flex-start;">
          <div>
            <h3 style="margin:0 0 6px;">1ì£¼ ë²Œê¸ˆ</h3>
            <div class="small">âœ…ë²Œê¸ˆì€ 1ì£¼ ë‹¨ìœ„ë¡œ ì •ì‚°í•˜ì—¬ ê·¸ì£¼ê°„ í† ,ì¼ ì•ˆì— ì¦‰ì‹œ ì…ê¸ˆí•©ë‹ˆë‹¤(í• ì¦ ë¶™ì„ ìˆ˜ë„ ìˆìŒ)âœ…ê³„ì¢Œë²ˆí˜¸: ì¹´ì¹´ì˜¤ë±…í¬ 33333326232531 ì˜¤ë¯¸ì§„</div>
          </div>

          <div id="adminControls" class="hidden" style="text-align:right;">
            <button class="danger" onclick="resetAll()">âš  ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”</button>
          </div>
        </div>
      </div>
      <div id="fine4wBody"></div>
    </div>

    <div id="accTime" class="screen hidden">
      <div class="card banner">
        <b>ì˜ì–´ë§í•˜ê¸°í›ˆë ¨ì„ ì‹¤ì œ ì–¼ë§ˆë‚˜ í–ˆëŠ”ì§€ ëˆ„ì ëŸ‰ì´ í‘œì‹œë©ë‹ˆë‹¤</b>
        <div class="small" style="margin-top:6px;">
          â€» ì´ ëˆ„ì  ë°ì´í„°ëŠ” â€œì „ì²´ ë°ì´í„° ì´ˆê¸°í™”â€ë¥¼ ëˆŒëŸ¬ë„ ì§€ì›Œì§€ì§€ ì•Šì•„ìš”. ì•±ì´ ì‚´ì•„ìˆëŠ” í•œ ê³„ì† ëˆ„ì ë©ë‹ˆë‹¤.
        </div>
      </div>

      <div id="accBody"></div>

      <div class="card">
        <b>ë§ˆë¬´ë¦¬</b>
        <div class="small" style="margin-top:6px;">ì €ì¥ì€ ìë™ìœ¼ë¡œ ë©ë‹ˆë‹¤. ì•„ë˜ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì´ë¦„ ì„ íƒ í™”ë©´ìœ¼ë¡œ ë‚˜ê°€ìš”.</div>
        <div class="footerActions">
          <button class="primary" onclick="logout()">ì €ì¥ ë° ë¡œê·¸ì•„ì›ƒ</button>
        </div>
      </div>
    </div>

  </div>
</div>

<div id="modalRoot" class="hidden"></div>
</body>
</html>
